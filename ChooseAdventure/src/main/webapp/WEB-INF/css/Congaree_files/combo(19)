YUI.add("flickr-groups-pools-add-creator",function(o,e){"use strict";o.namespace("ModelCreators")["flickr-groups-pools-add"]={run:function(t,r){var p=this,s=this._processParams(t),l=t.registryName||"group-pool-models",u={apiResponse:r.callAPI("flickr.groups.pools.add",s),groupPoolModel:r.getModel(l,t.groupID),photoModel:r.getModel("photo-models",t.photoID),photoGroupsModelRegistry:r.getModelRegistry("photo-groups-models"),photoContextsModelRegistry:r.getModelRegistry("photo-contexts-models")};return t.unfilteredGroupId=s.group_id,"group-pool-models"!==l&&(u.unfilteredGroupPoolModel=r.getModel("group-pool-models",t.unfilteredGroupId)),new o.FlickrPromise(u).then(function(o){return p._processResponse(o,t)},o.FetcherErrorLogger(e))},_processParams:function(e){return{photo_id:e.photoID,group_id:o.Models["group-pool-models"].extractGroupFromCompoundId(e.groupID)}},_processResponse:function(o,e){var t=o.apiResponse,r=o.groupPoolModel,p=o.photoModel,s=o.photoGroupsModelRegistry,l=o.photoContextsModelRegistry,u=o.unfilteredGroupPoolModel;if("ok"===t.stat)return r&&!r.hasPhoto(p.getValue("id"))&&(r.addPhotoLocal(p),r.getValue("group").setValue("poolCount",r.getValue("group").getValue("poolCount")+1)),u&&u.hasPhoto(p.getValue("id"))&&u.addPhotoLocal(p),s.exists(e.photoID)&&!s.getValue(e.photoID,"groups").getFromListByID(e.unfilteredGroupId)&&(s.getValue(e.photoID,"groups").unshift(r),s.setValue(e.photoID,"total",s.getValue(e.photoID,"total")+1)),l.exists(e.photoID)&&!l.getValue(e.photoID,"contexts").getFromListByID(e.unfilteredGroupId)&&(l.setValue(e.photoID,"totalGroups",l.getValue(e.photoID,"totalGroups")+1),l.getValue(e.photoID,"contexts").push(r)),r}}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});YUI.add("flickr-groups-pools-remove-deletor",function(o,e){"use strict";o.namespace("ModelDeletors")["flickr-groups-pools-remove"]={run:function(t,r){var s=this,p=this._processParams(t),l=t.registryName||"group-pool-models",u={apiResponse:r.callAPI("flickr.groups.pools.remove",p),groupPoolModelRegistry:r.getModel(l,t.groupID),photoModelRegistry:r.getModel("photo-models",t.photoID),photoGroupsModelRegistry:r.getModelRegistry("photo-groups-models"),photoContextsModelRegistry:r.getModelRegistry("photo-contexts-models")};return t.unfilteredGroupId=p.group_id,"group-pool-models"!==l&&(u.unfilteredGroupPoolModelRegistry=r.getModel("group-pool-models",t.unfilteredGroupId)),new o.FlickrPromise(u).then(function(o){return s._processResponse(o,t)},o.FetcherErrorLogger(e))},_processParams:function(e){return{photo_id:e.photoID,group_id:o.Models["group-pool-models"].extractGroupFromCompoundId(e.groupID)}},_processResponse:function(o,e){var t=o.apiResponse,r=o.groupPoolModelRegistry,s=o.photoModelRegistry,p=o.photoGroupsModelRegistry,l=o.photoContextsModelRegistry,u=o.unfilteredGroupPoolModelRegistry;if("ok"===t.stat)return l.exists(e.photoID)&&l.getValue(e.photoID,"contexts").getFromListByID(e.unfilteredGroupId)&&(l.setValue(e.photoID,"totalGroups",l.getValue(e.photoID,"totalGroups")-1),l.getValue(e.photoID,"contexts").removeFromList(e.unfilteredGroupId)),p.exists(e.photoID)&&p.getValue(e.photoID,"groups").getFromListByID(e.unfilteredGroupId)&&(p.setValue(e.photoID,"total",p.getValue(e.photoID,"total")-1),p.getValue(e.photoID,"groups").removeFromList(e.unfilteredGroupId)),r&&(r.hasPhoto(s.getValue("id"))&&r.removePhotoLocal(s),r.getValue("group").setValue("poolCount",r.getValue("group").getValue("poolCount")-1)),u&&u.hasPhoto(s.getValue("id"))&&u.removePhotoLocal(s),r}}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});YUI.add("flickr-groups-invite-photo-invite-creator",function(o,t){"use strict";o.namespace("ModelCreators")["flickr-groups-invite-photo-invite"]={run:function(e,i){var r={},p=o.Models["group-pool-models"].extractGroupFromCompoundId(e.groupID);return r.photo_id=e.photoID,r.group_id=p,o.Promise.all([i.callAPI("flickr.groups.invite.photo.invite",r),i.getModel("group-pool-models",p),i.getModelRegistry("photo-group-invitation-models"),i.getModelRegistry("photo-group-invitations-models")]).then(function(o){var t,r,n,s=o[0],l=o[1],u=o[2],d=o[3];if("ok"===s.stat)return t=[e.photoID,p].join("-"),r={id:t,photoId:e.photoID,groupId:p,invitedBy:i.getViewer().nsid},n=u.exists(t)?u.proxy(t):u.add(r),d.exists(e.photoID)&&!d.getValue(e.photoID,"invitations").getFromListByID(t)&&(d.getValue(e.photoID,"groups").prependToList(l),d.getValue(e.photoID,"invitations").prependToList(n),d.setValue(e.photoID,"total",d.getValue(e.photoID,"total")+1)),l},o.FetcherErrorLogger(t))}}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});YUI.add("flickr-groups-invite-photo-cancel-deletor",function(o,t){"use strict";o.namespace("ModelDeletors")["flickr-groups-invite-photo-cancel"]={run:function(e,r){var i={},l=o.Models["group-pool-models"].extractGroupFromCompoundId(e.groupID);return i.photo_id=e.photoID,i.group_id=l,o.Promise.all([r.callAPI("flickr.groups.invite.photo.cancel",i),r.getModel("group-pool-models",l),r.getModelRegistry("photo-group-invitation-models"),r.getModelRegistry("photo-group-invitations-models")]).then(function(o){var t,r=o[0],i=o[1],p=o[2],s=o[3];if("ok"===r.stat)return t=[e.photoID,l].join("-"),s.exists(e.photoID)&&s.getValue(e.photoID,"invitations").getFromListByID(t)&&(s.setValue(e.photoID,"total",s.getValue(e.photoID,"total")-1),s.getValue(e.photoID,"groups").removeFromList(l),s.getValue(e.photoID,"invitations").removeFromList(t)),p.remove(t),i},o.FetcherErrorLogger(t))}}},"@VERSION@",{requires:["flickr-promise","group-pool-models"],optional:[]});YUI.add("group-pool-by-person-models",function(e){function o(e){o.superclass.constructor.call(this,e)}e.Models[this.name]=o,e.extend(o,e.Models["group-pool-models"],{name:this.name,attributes:e.merge(e.Models["group-pool-models"].prototype.attributes,{personFilter:{validator:function(o,r){return e.AttributeHelpers.validateString(o)},setter:function(o){return e.AttributeHelpers.coerceString(o)},defaultValue:null}})})},"@VERSION@",{requires:["attribute-helpers","group-pool-models","flickr-groups-pools-getPhotos-fetcher","flickr-groups-pools-add-creator","flickr-groups-pools-remove-deletor","flickr-groups-invite-photo-invite-creator","flickr-groups-invite-photo-cancel-deletor"]});YUI.add("group-pool-by-tag-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.Models["group-pool-models"],{name:this.name,attributes:{tagFilter:{validator:function(e,r){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e)},defaultValue:null}}})},"@VERSION@",{requires:["attribute-helpers"]});